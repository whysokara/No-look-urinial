<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöΩ The Ultimate Urinal Optimizer</title>
    <link href="https://unpkg.com/@magicpatterns/magic/dist/magic.css" rel="stylesheet">
    <style>
        .urinal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            max-width: 600px;
            gap: 16px;
            margin: 32px auto;
            padding: 32px;
            background: var(--magic-background-subtle);
            border-radius: var(--magic-radius-xl);
        }

        .urinal-btn {
            aspect-ratio: 1;
            border: none;
            border-radius: var(--magic-radius-lg);
            cursor: pointer;
            transition: all 0.3s var(--magic-ease-bounce);
            background: var(--magic-background-muted);
            position: relative;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .urinal-btn:hover {
            transform: translateY(-2px);
        }

        .urinal-btn.occupied {
            background: var(--magic-error-muted);
            transform: scale(1.05);
        }

        .urinal-btn.recommended {
            background: var(--magic-success-muted);
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1) translateY(-5px); }
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 32px 0;
        }

        .main-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 32px 16px;
        }

        .input-section {
            max-width: 400px;
            margin: 0 auto;
        }
    </style>
</head>
<body class="magic-container">
    <div class="main-container">
        <!-- Header Section -->
        <header class="magic-section text-center mb-8">
            <div class="magic-badge magic-badge-purple mb-4"></div>
            <h1 class="magic-heading-1 mb-2">üöΩ Ultimate Urinal Optimizer</h1>
            <p class="magic-text-lg mb-2">Because bathroom anxiety is real.</p>
            <p class="magic-text magic-text-muted">"With great bladder comes great responsibility"</p>
        </header>

        <!-- Main Card -->
        <div class="magic-card magic-p-6">
            <!-- Input Section -->
            <div class="input-section">
                <div class="magic-form-group">
                    <label class="magic-label">How many urinals are we working with? (1-20)</label>
                    <div class="magic-input-group">
                        <span class="magic-input-icon">üéØ</span>
                        <input type="number" 
                               class="magic-input" 
                               id="totalUrinals" 
                               min="1" 
                               max="20" 
                               value="5">
                    </div>
                    <small class="magic-text-sm magic-text-muted">Pro tip: Most bathrooms have 3-7 urinals</small>
                </div>

                <button class="magic-button magic-button-primary w-full mt-4" onclick="generateUrinals()">
                    Deploy the Urinals üéÆ
                </button>
            </div>

            <!-- Urinal Display -->
            <div class="urinal-grid" id="urinalDisplay"></div>

            <!-- Stats Section -->
            <div class="stats-container">
                <div class="magic-card magic-card-hover">
                    <div class="magic-text-sm magic-text-muted">Privacy Level</div>
                    <div class="magic-text-xl">Maximum</div>
                </div>
                <div class="magic-card magic-card-hover">
                    <div class="magic-text-sm magic-text-muted">Awkwardness</div>
                    <div class="magic-text-xl">Minimal</div>
                </div>
            </div>

            <!-- Action Button -->
            <button class="magic-button magic-button-secondary w-full" onclick="findOptimal()">
                Find Your Perfect Spot üéØ
            </button>

            <!-- Result Area -->
            <div id="result" class="mt-4"></div>

            <!-- Instructions -->
            <div class="magic-alert magic-alert-info mt-6">
                <div class="magic-alert-title">Quick Guide:</div>
                <ol class="magic-text-sm mt-2">
                    <li>1. Enter the number of urinals</li>
                    <li>2. Click to mark occupied spots</li>
                    <li>3. Let the algorithm find your optimal position</li>
                </ol>
            </div>
        </div>

        <!-- Footer -->
        <footer class="magic-text-center magic-text-sm magic-text-muted mt-8">
            Powered by social anxiety and complex algorithms<br>
            Made with üíñ by people who understand the struggle
        </footer>
    </div>

    <script>
        let occupiedPositions = new Set();

        function generateUrinals() {
            const total = parseInt(document.getElementById('totalUrinals').value);
            if (total < 1 || total > 20) {
                showError('Whoa there! Let\'s keep it between 1 and 20 urinals. We\'re not building a stadium... yet.');
                return;
            }

            occupiedPositions.clear();
            const container = document.getElementById('urinalDisplay');
            container.innerHTML = '';
            
            // Adjust grid columns based on total
            const columns = Math.min(5, total);
            container.style.gridTemplateColumns = `repeat(${columns}, 1fr)`;

            for (let i = 1; i <= total; i++) {
                const urinal = document.createElement('button');
                urinal.className = 'urinal-btn';
                urinal.innerHTML = 'üöΩ';
                urinal.dataset.position = i;
                urinal.onclick = function() {
                    toggleUrinal(i, urinal);
                };
                container.appendChild(urinal);
            }
            document.getElementById('result').innerHTML = '';
        }

        function toggleUrinal(position, element) {
            if (occupiedPositions.has(position)) {
                occupiedPositions.delete(position);
                element.classList.remove('occupied');
                element.innerHTML = 'üöΩ';
            } else {
                occupiedPositions.add(position);
                element.classList.add('occupied');
                element.innerHTML = 'üë§';
            }
        }

        function showError(message) {
            document.getElementById('result').innerHTML = `
                <div class="magic-alert magic-alert-error">
                    <div class="magic-alert-title">Oops! üòÖ</div>
                    ${message}
                </div>`;
        }

        function showSuccess(position) {
            const messages = [
                `Position ${position} is your safe haven! üéØ`,
                `Urinal ${position} offers maximum privacy! üõ°Ô∏è`,
                `Go for #${position} - it's the sweet spot! ‚ú®`,
                `Position ${position} - perfectly balanced, as all things should be! üéÆ`
            ];
            
            document.getElementById('result').innerHTML = `
                <div class="magic-alert magic-alert-success">
                    <div class="magic-alert-title">Perfect Spot Found! üéâ</div>
                    ${messages[Math.floor(Math.random() * messages.length)]}
                </div>`;
        }

        function findOptimal() {
            const total = parseInt(document.getElementById('totalUrinals').value);
            
            fetch('/calculate', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    totalUrinals: total,
                    occupied: Array.from(occupiedPositions)
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    showError(data.error);
                    return;
                }
                
                document.querySelectorAll('.urinal-btn').forEach(u => {
                    if (u.classList.contains('recommended')) {
                        u.classList.remove('recommended');
                        u.innerHTML = 'üöΩ';
                    }
                });
                
                const recommendedUrinal = document.querySelector(`[data-position="${data.optimal}"]`);
                if (recommendedUrinal) {
                    recommendedUrinal.classList.add('recommended');
                    recommendedUrinal.innerHTML = '‚ú®';
                }
                
                showSuccess(data.optimal);
            })
            .catch(error => {
                showError("Something went wrong! Maybe the urinals are on strike? ü§î");
            });
        }

        // Generate initial urinals
        generateUrinals();
    </script>
</body>
</html> 